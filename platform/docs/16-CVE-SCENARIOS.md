# Scénarios et labs basés sur les CVE

Ce document décrit comment **ajouter des labs et scénarios centrés sur des CVE** (Common Vulnerabilities and Exposures), comment structurer les missions et cours, et comment viser à terme **une large couverture des vulnérabilités** (CVE.org, NVD) : HPP, RCE, DoS, XSS, injection, etc.

## Objectif

- **Court terme** : avoir des labs avec étapes, défis et cours pour des CVE ciblées (ex. CVE-2025-7783 form-data HPP).
- **Moyen / long terme** : pouvoir ajouter de nombreux scénarios CVE (RCE, DoS, injection, XSS, etc.) et tendre vers une **grande partie des vulnérabilités disponibles** sur CVE.org / NVD, en les organisant par type et par produit.

## Structure d’un lab CVE dans le projet

Chaque CVE peut être couverte par :

1. **Un scénario** (`platform/public/data/scenarios.json`)  
   - `id` : ex. `scenario-cve-2025-7783-form-data`  
   - `cveId` : ex. `CVE-2025-7783`  
   - `title`, `description`, `difficulty`, `category`, `tags` (CVE, HPP, RCE, DoS, etc.)  
   - `tasks` : étapes (ouvrir la fiche CVE, comprendre le type, versions affectées, mission correctif / exploitation)

2. **Un défi** (`platform/public/data/challenges.json`)  
   - `id` : ex. `chall-11-cve-2025-7783-form-data`  
   - `title`, `category`, `description`, `hint`, `validation`

3. **Un cours / sous-catégorie** (`platform/public/data/learning.json`)  
   - Dans le thème **CVE & Vulnérabilités**, ajouter une `subcategory` avec le résumé de la CVE, les versions affectées, le correctif et un lien NVD.

4. **Optionnel** : une cible ou un environnement de lab dédié (conteneur vulnérable, app de démo) pour reproduire la vulnérabilité.

## Types de vulnérabilités à couvrir

À prévoir pour les prochains scénarios CVE :

| Type | Description | Exemples |
|------|-------------|----------|
| **HPP** | HTTP Parameter Pollution | CVE-2025-7783 (form-data) |
| **RCE** | Remote Code Execution | Divers CVE sur services, librairies |
| **DoS** | Denial of Service | CVE sur stacks réseau, parsers |
| **Injection** | SQLi, NoSQLi, commande, LDAP | CVE sur applications, APIs |
| **XSS** | Cross-Site Scripting | CVE sur moteurs de rendu, CMS |
| **SSRF** | Server-Side Request Forgery | CVE sur clients HTTP, proxies |
| **Auth / Bypass** | Contournement d’authentification | CVE sur auth, JWT, sessions |
| **Info disclosure** | Fuite d’informations | CVE sur logs, erreurs, debug |
| **Autres** | Déni de service logique, désérialisation, etc. | Selon CVE.org / NVD |

## Comment ajouter un nouveau scénario CVE

1. **Choisir une CVE** (NVD, CVE.mitre.org, veille).
2. **Rédiger** :
   - Un scénario avec 3–5 tâches (ouvrir la CVE, comprendre le type, versions, mission).
   - Un défi avec hint et critère de validation.
   - Une sous-catégorie dans Doc & Cours → CVE & Vulnérabilités.
3. **Ajouter** dans `scenarios.json` un objet avec `cveId`, `tags` (CVE + type : RCE, DoS, etc.).
4. **Ajouter** dans `challenges.json` un défi lié.
5. **Mettre à jour** `learning.json` (topic `cve`, `subcategories`) avec le résumé de la CVE.

### Template minimal scénario CVE

```json
{
  "id": "scenario-cve-XXXX-YYYY-nom-produit",
  "cveId": "CVE-XXXX-YYYY",
  "title": "Lab CVE : [produit] – [type]",
  "description": "[Résumé de la CVE et objectif du lab]",
  "difficulty": "Easy",
  "category": "web",
  "tags": ["CVE", "RCE"],
  "time": "25 min",
  "machines": [
    { "name": "Bouton CVE", "url": "#", "note": "Panneau CVE" },
    { "name": "NVD", "url": "https://nvd.nist.gov/vuln/detail/CVE-XXXX-YYYY", "note": "Fiche NVD" }
  ],
  "tasks": [
    { "title": "1. Ouvrir la fiche CVE", "content": "...", "command": null, "tip": "...", "learn": "..." },
    { "title": "2. Comprendre le type", "content": "...", "command": null, "tip": "...", "learn": "..." },
    { "title": "3. Versions affectées", "content": "...", "command": "...", "tip": "...", "learn": "..." },
    { "title": "4. Mission", "content": "...", "command": null, "tip": "...", "learn": "..." }
  ]
}
```

## Intégration CVE.org / NVD

- La plateforme utilise déjà le **bouton CVE** (panneau) pour la recherche par ID ou par mot-clé (API NVD 2.0).
- Pour scaler : on peut **enrichir les scénarios** avec un lien direct NVD (`https://nvd.nist.gov/vuln/detail/CVE-XXXX-YYYY`) et, à terme, envisager :
  - un import ou une synchro depuis l’API NVD (liste de CVE par produit / type) ;
  - un filtre dans la liste des scénarios par `cveId` ou par tag (RCE, DoS, HPP, etc.).

## Références

- [NVD (NIST)](https://nvd.nist.gov/vuln/search) — recherche et fiches CVE  
- [CVE.mitre.org](https://cve.mitre.org/) — liste officielle CVE  
- [CVE-2025-7783 (form-data HPP)](https://nvd.nist.gov/vuln/detail/CVE-2025-7783) — premier lab CVE ajouté (voir scénario, défi et cours associés)

---
*Ce document sert de référence pour ajouter progressivement des scénarios CVE (RCE, DoS, injection, etc.) et viser une couverture large des vulnérabilités disponibles sur CVE.org.*
